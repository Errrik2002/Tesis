d_TNF <- (alpha5*((n1**h1)/((n1**h1)+IL10**h1)))*Mi-mu7*(TNF-qTNF)+((alpha5*((n1**h1)/((n1**h1)+IL10**h1)))*Ci)#*0.25
d_IL10 <- alpha7*Mi - mu9*(IL10-qIL10)
return(list(c(d_TL,d_M,d_Cn,d_Mi,d_Ci,d_TNF,d_IL10)))
})
}
parameter <- c(alpha1,alpha2, mu1, nu1, mu2, mu3, alpha3, alpha4, mu5, mu6, alpha5, alpha7, mu7, mu9, n1, n2, h1, h2, qIL10, qTNF,M0)
state <- c(TL=50, M=209, Cn= 136, Mi= 0, Ci = 0, TNF = 22, IL10 =9.8)
times <- seq(0,5000, by=1)
parametros_signos_bien_27_mar_nosave <- ode(y= state, times = times, func= trypanosoma_29_NOV, parms = parameter)
plot(parametros_signos_bien_27_mar_nosave,col='red')
library(deSolve)
alpha1 <- 5.8*10**-8 #1 o 3.14, ELISA D H
alpha2 <- 2.5*10**-9 #2
#mu1 <- 0.06 # REFERENCIA DE YANG 2015 (HAY OTRO VALOR)
mu1 <- 0.06 #3
nu1 <- 1 # REFERENCIA DE FREITAS, LA OTRA OPCION ES MUY DRASTICA  #4
mu2 <- 5*10**-1 #5
mu3 <- 0 #MISMO VALOR QUE EL DE LOS MACROFAGOS, MU2 #6
alpha3 <- 0 #replicacion Mi #8 PUEDE VARIAR SI ES M1 O M2
alpha4 <- 90 #Replicacion Ci #9
mu5 <- 5*10**-1 #10 #NO AFECTAN, PUEDE SER POR LAS CITOCINAS
mu6 <- 1*10**-6 #11
alpha5 <- 14.4 #12
alpha7 <- 0.45 #SECRECION DE IL10 #13
mu7 <- 24 #TASA DE degradacion DE TNF #en base a la literatura CADA 18 MIN #14 #24
mu9 <- 19.2 #15 Degradacion de IL10
n1 <- 17.4 #TNF-IL10
n2 <- 560 #IL10-IL6
h1 <- 3 #TNF-IL10
h2 <- 3.68 #IL10-IL6
M0 <-209# NUMERO EQUIS
qTNF <- 0.14 #16
qIL10 <- 0.15 #17
n3 <- 100 #MTNF
h3 <- 3.16 #MTNF
n4 <- 4.35 #MIL10
h4 <- 0.3#MIL10
trypanosoma_29_NOV <- function(t,state,parameter){
with(as.list(c(state,parameter)),  {
d_TL <- -(alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-alpha2*TL*Cn-(mu1*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*TL+(alpha3*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Mi+alpha4*Ci
d_M <- (nu1*((TNF**h1)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*(M0-M)-(alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-(mu2*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*M
d_Cn <- -alpha2*TL*Cn-(mu3*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Cn
d_Mi <- (alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-(mu5*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Mi
d_Ci <- alpha2*TL*Cn-(mu6*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Ci
d_TNF <- (alpha5*((n1**h1)/((n1**h1)+IL10**h1)))*Mi-mu7*(TNF-qTNF)+((alpha5*((n1**h1)/((n1**h1)+IL10**h1)))*Ci)#*0.25
d_IL10 <- alpha7*Mi - mu9*(IL10-qIL10)
return(list(c(d_TL,d_M,d_Cn,d_Mi,d_Ci,d_TNF,d_IL10)))
})
}
parameter <- c(alpha1,alpha2, mu1, nu1, mu2, mu3, alpha3, alpha4, mu5, mu6, alpha5, alpha7, mu7, mu9, n1, n2, h1, h2, qIL10, qTNF,M0)
state <- c(TL=50, M=209, Cn= 136, Mi= 0, Ci = 0, TNF = 22, IL10 =9.8)
times <- seq(0,5000, by=1)
parametros_signos_bien_27_mar_nosave <- ode(y= state, times = times, func= trypanosoma_29_NOV, parms = parameter)
plot(parametros_signos_bien_27_mar_nosave,col='red')
plot(parametros_signos_bien_27_mar_nosave,col='red')
library(deSolve)
#Parametros
alpha1 <- 5.8*10**-8 #1 o 3.14, ELISA D H
alpha2 <- 2.5*10**-9 #2
#mu1 <- 0.06 # REFERENCIA DE YANG 2015 (HAY OTRO VALOR)
mu1 <- 0.06 #3
nu1 <- 1 # REFERENCIA DE FREITAS, LA OTRA OPCION ES MUY DRASTICA  #4
mu2 <- 5*10**-1 #5
mu3 <- 0 #MISMO VALOR QUE EL DE LOS MACROFAGOS, MU2 #6
alpha3 <- 0 #replicacion Mi #8 PUEDE VARIAR SI ES M1 O M2
alpha4 <- 90 #Replicacion Ci #9
mu5 <- 5*10**-1 #10 #NO AFECTAN, PUEDE SER POR LAS CITOCINAS
mu6 <- 1*10**-6 #11
alpha5 <- 14.4 #12
alpha7 <- 0.45 #SECRECION DE IL10 #13
mu7 <- 24 #TASA DE degradacion DE TNF #en base a la literatura CADA 18 MIN #14 #24
mu9 <- 19.2 #15 Degradacion de IL10
n1 <- 17.4 #TNF-IL10
n2 <- 560 #IL10-IL6
h1 <- 3 #TNF-IL10
h2 <- 3.68 #IL10-IL6
M0 <-209# NUMERO EQUIS
qTNF <- 0.14 #16
qIL10 <- 0.15 #17
n3 <- 100 #MTNF
h3 <- 3.16 #MTNF
n4 <- 4.35 #MIL10
h4 <- 0.3#MIL10
trypanosoma_29_NOV <- function(t,state,parameter){
with(as.list(c(state,parameter)),  {
d_TL <- -(alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-alpha2*TL*Cn-(mu1*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*TL+(alpha3*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Mi+alpha4*Ci
d_M <- (nu1*((TNF**h1)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*(M0-M)-(alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-(mu2*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*M
d_Cn <- -alpha2*TL*Cn-(mu3*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Cn
d_Mi <- (alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-(mu5*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Mi
d_Ci <- alpha2*TL*Cn-(mu6*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Ci
d_TNF <- (alpha5*((n1**h1)/((n1**h1)+IL10**h1)))*Mi-mu7*(TNF-qTNF)+((alpha5*((n1**h1)/((n1**h1)+IL10**h1)))*Ci)#*0.25
d_IL10 <- alpha7*Mi - mu9*(IL10-qIL10)
return(list(c(d_TL,d_M,d_Cn,d_Mi,d_Ci,d_TNF,d_IL10)))
})
}
parameter <- c(alpha1,alpha2, mu1, nu1, mu2, mu3, alpha3, alpha4, mu5, mu6, alpha5, alpha7, mu7, mu9, n1, n2, h1, h2, qIL10, qTNF,M0)
state <- c(TL=50, M=209, Cn= 136, Mi= 0, Ci = 0, TNF = 22, IL10 =9.8)
times <- seq(0,5000, by=1)
parametros_signos_bien_27_mar_nosave <- ode(y= state, times = times, func= trypanosoma_29_NOV, parms = parameter)
plot(parametros_signos_bien_27_mar_nosave,col='red')
times <- seq(0,3650, by=1)
parametros_signos_bien_27_mar_nosave <- ode(y= state, times = times, func= trypanosoma_29_NOV, parms = parameter)
plot(parametros_signos_bien_27_mar_nosave,col='red')
png("images/Parametros_normales_28_mar_25.png",width = 480, height = 700)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
png("images/Parametros_normales_28_mar_25.png",width = 600, height = 900)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
png("images/Parametros_normales_28_mar_25.png",width = 600, height = 750)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
png("images/Parametros_normales_28_mar_25.png",width = 300, height = 480)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
png("images/Parametros_normales_28_mar_25.png",width = 600, height = 960)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
png("images/Parametros_normales_28_mar_25.png",width = 600, height = 930)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
pdf("images/Parametros_normales_28_mar_25.pdf",width = 600, height = 930)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
pdf("images/Parametros_normales_28_mar_25.pdf",width = 300, height = 460)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
pdf("images/Parametros_normales_28_mar_25.pdf",width = 30, height = 46)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
pdf("images/Parametros_normales_28_mar_25.pdf",width = 3, height = 4.6)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
pdf("images/Parametros_normales_28_mar_25.pdf",width = 15, height = 24)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
pdf("images/Parametros_normales_28_mar_25.pdf",width = 12, height = 19.2)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
pdf("images/Parametros_normales_28_mar_25.pdf",width = 12, height = 18)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
png("images/Parametros_normales_28_mar_25.png",width = 120, height = 180)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
png("images/Parametros_normales_28_mar_25.png",width = 120, height = 280)
plot(parametros_signos_bien_27_mar_nosave,col='red')
png("images/Parametros_normales_28_mar_25.png",width = 1, height = 280)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
png("images/Parametros_normales_28_mar_25.png",width = 120, height = 280)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
png("images/Parametros_normales_28_mar_25.png",width = 120, height = 240)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
png("images/Parametros_normales_28_mar_25.png",width = 300, height = 480)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
png("images/Parametros_normales_28_mar_25.png",width = 600, height = 960)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
pdf("images/Parametros_normales_28_mar_25.pdf",width = 12, height = 18)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
pdf("images/Parametros_normales_28_mar_25.pdf",width = 12, height = 16)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
pdf("images/Parametros_normales_28_mar_25.pdf",width = 8, height = 12)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
pdf("images/Parametros_normales_28_mar_25.pdf",width = 6, height = 10)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
pdf("images/Parametros_normales_28_mar_25.pdf",width = 6, height = 9)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
pdf("images/Parametros_normales_28_mar_25.pdf",width = 6, height = 8)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
pdf("images/Parametros_normales_28_mar_25.pdf",width = 6, height = 7)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
pdf("images/Parametros_normales_28_mar_25.pdf",width = 6, height = 8)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
alpha7 <- 10 #SECRECION DE IL10 #13
alpha7 <- 14.4 #SECRECION DE IL10 #13
trypanosoma_29_NOV <- function(t,state,parameter){
with(as.list(c(state,parameter)),  {
d_TL <- -(alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-alpha2*TL*Cn-(mu1*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*TL+(alpha3*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Mi+alpha4*Ci
d_M <- (nu1*((TNF**h1)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*(M0-M)-(alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-(mu2*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*M
d_Cn <- -alpha2*TL*Cn-(mu3*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Cn
d_Mi <- (alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-(mu5*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Mi
d_Ci <- alpha2*TL*Cn-(mu6*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Ci
d_TNF <- (alpha5*((n1**h1)/((n1**h1)+IL10**h1)))*Mi-mu7*(TNF-qTNF)+((alpha5*((n1**h1)/((n1**h1)+IL10**h1)))*Ci)#*0.25
d_IL10 <- alpha7*Mi - mu9*(IL10-qIL10)
return(list(c(d_TL,d_M,d_Cn,d_Mi,d_Ci,d_TNF,d_IL10)))
})
}
parameter <- c(alpha1,alpha2, mu1, nu1, mu2, mu3, alpha3, alpha4, mu5, mu6, alpha5, alpha7, mu7, mu9, n1, n2, h1, h2, qIL10, qTNF,M0)
state <- c(TL=50, M=209, Cn= 136, Mi= 0, Ci = 0, TNF = 22, IL10 =9.8)
times <- seq(0,3650, by=1)
parametros_signos_bien_27_mar_nosave <- ode(y= state, times = times, func= trypanosoma_29_NOV, parms = parameter)
plot(parametros_signos_bien_27_mar_nosave,col='red')
alpha7 <- 10 #SECRECION DE IL10 #13
trypanosoma_29_NOV <- function(t,state,parameter){
with(as.list(c(state,parameter)),  {
d_TL <- -(alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-alpha2*TL*Cn-(mu1*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*TL+(alpha3*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Mi+alpha4*Ci
d_M <- (nu1*((TNF**h1)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*(M0-M)-(alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-(mu2*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*M
d_Cn <- -alpha2*TL*Cn-(mu3*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Cn
d_Mi <- (alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-(mu5*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Mi
d_Ci <- alpha2*TL*Cn-(mu6*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Ci
d_TNF <- (alpha5*((n1**h1)/((n1**h1)+IL10**h1)))*Mi-mu7*(TNF-qTNF)+((alpha5*((n1**h1)/((n1**h1)+IL10**h1)))*Ci)#*0.25
d_IL10 <- alpha7*Mi - mu9*(IL10-qIL10)
return(list(c(d_TL,d_M,d_Cn,d_Mi,d_Ci,d_TNF,d_IL10)))
})
}
parameter <- c(alpha1,alpha2, mu1, nu1, mu2, mu3, alpha3, alpha4, mu5, mu6, alpha5, alpha7, mu7, mu9, n1, n2, h1, h2, qIL10, qTNF,M0)
state <- c(TL=50, M=209, Cn= 136, Mi= 0, Ci = 0, TNF = 22, IL10 =9.8)
times <- seq(0,3650, by=1)
parametros_signos_bien_27_mar_nosave <- ode(y= state, times = times, func= trypanosoma_29_NOV, parms = parameter)
plot(parametros_signos_bien_27_mar_nosave,col='red')
pdf("images/Parametros_normales_28_mar_25.pdf",width = 6, height = 8)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
alpha7 <- 14.4 #SECRECION DE IL10 #13
trypanosoma_29_NOV <- function(t,state,parameter){
with(as.list(c(state,parameter)),  {
d_TL <- -(alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-alpha2*TL*Cn-(mu1*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*TL+(alpha3*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Mi+alpha4*Ci
d_M <- (nu1*((TNF**h1)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*(M0-M)-(alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-(mu2*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*M
d_Cn <- -alpha2*TL*Cn-(mu3*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Cn
d_Mi <- (alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-(mu5*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Mi
d_Ci <- alpha2*TL*Cn-(mu6*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Ci
d_TNF <- (alpha5*((n1**h1)/((n1**h1)+IL10**h1)))*Mi-mu7*(TNF-qTNF)+((alpha5*((n1**h1)/((n1**h1)+IL10**h1)))*Ci)#*0.25
d_IL10 <- alpha7*Mi - mu9*(IL10-qIL10)
return(list(c(d_TL,d_M,d_Cn,d_Mi,d_Ci,d_TNF,d_IL10)))
})
}
parameter <- c(alpha1,alpha2, mu1, nu1, mu2, mu3, alpha3, alpha4, mu5, mu6, alpha5, alpha7, mu7, mu9, n1, n2, h1, h2, qIL10, qTNF,M0)
state <- c(TL=50, M=209, Cn= 136, Mi= 0, Ci = 0, TNF = 22, IL10 =9.8)
times <- seq(0,3650, by=1)
parametros_signos_bien_27_mar_nosave <- ode(y= state, times = times, func= trypanosoma_29_NOV, parms = parameter)
plot(parametros_signos_bien_27_mar_nosave,col='red')
pdf("images/Parametros_normales_28_mar_25.pdf",width = 6, height = 8)
plot(parametros_signos_bien_27_mar_nosave,col='red')
dev.off()
alpha7 <- 0.45 #SECRECION DE IL10 #13
######################################################
#CICLO FOR PARA ANALISIS DE SENSIBILIDAD PARAMETRICA ########################################################################
#############################################################################################################################
#####################################################
parametronormales <- readRDS("objetosRDS/Parametrosnormales.rds")
nombre_columnas <-colnames(parametronormales) #nombre de columnas
signos_bien_parametros_normales <- readRDS("analisis_sensibilidad_param_signos_bien/parametros_normales_signos_bien.rds")
analisis_SP <- function(p,np,nv){
alpha1 <- 5.8*10**-8 #1 o 3.14, ELISA D H
alpha2 <- 2.5*10**-9 #2
#mu1 <- 0.06 # REFERENCIA DE YANG 2015 (HAY OTRO VALOR)
mu1 <- 0.06 #3
nu1 <- 1 # REFERENCIA DE FREITAS, LA OTRA OPCION ES MUY DRASTICA  #4
mu2 <- 5*10**-1 #5
mu3 <- 0 #MISMO VALOR QUE EL DE LOS MACROFAGOS, MU2 #6
alpha3 <- 0 #replicacion Mi #8 PUEDE VARIAR SI ES M1 O M2
alpha4 <- 90 #Replicacion Ci #9
mu5 <- 5*10**-1 #10 #NO AFECTAN, PUEDE SER POR LAS CITOCINAS
mu6 <- 1*10**-6 #11
alpha5 <- 14.4 #12
alpha7 <- 0.45 #SECRECION DE IL10 #13
mu7 <- 24 #TASA DE degradacion DE TNF #en base a la literatura CADA 18 MIN #14
mu9 <- 19.2 #15 Degradacion de IL10
n1 <- 17.4 #TNF-IL10
n2 <- 560 #IL10-IL6
h1 <- 3 #TNF-IL10
h2 <- 3.68 #IL10-IL6
M0 <-209# NUMERO EQUIS
qTNF <- 0.14 #16
qIL10 <- 0.15 #17
n3 <- 100 #MTNF
h3 <- 3.16 #MTNF
n4 <- 4.35 #MIL10
h4 <- 0.3#MIL10
nombre_columnas <-colnames(parametronormales)
pn <- as.numeric(p)
p_1 <- pn
parametros <- c("alpha1","alpha2", "mu1", "nu1", "mu2", "mu3", "alpha3", "alpha4", "mu5", "mu6", "alpha5", "alpha7", "mu7", "mu9", "n1", "n2", "h1", "h2", "qIL10", "qTNF","M0")
columna_basedatos <-paste("variable",nombre_columnas[nv],p,sep = "")
basedatos_variables <- data.frame(parametro = p,
columna_basedatos=signos_bien_parametros_normales[3651,nv])
parameter <- c(alpha1,alpha2, mu1, nu1, mu2, mu3, alpha3, alpha4, mu5, mu6, alpha5, alpha7, mu7, mu9, n1, n2, h1, h2, qIL10, qTNF,M0)
state <- c(TL=50, M=209, Cn= 136, Mi= 0, Ci = 0, TNF = 22, IL10 =9.8)
times <- seq(0,3650, by=1)
for (x in 1:10){
################################################
alpha1 <- pn #hacelo cambiar dependiendo el parametro
#####################voy a tener que hacerlo manual
#COLOCAR AQUI EL PARAMETRO QUE ESTAMOS ESCOGIENDO
trypanosoma_29_NOV <- function(t,state,parameter){
with(as.list(c(state,parameter)),  {
d_TL <- -(alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-alpha2*TL*Cn-(mu1*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*TL+(alpha3*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Mi+alpha4*Ci
d_M <- (nu1*((TNF**h1)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*(M0-M)-(alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-(mu2*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*M
d_Cn <- -alpha2*TL*Cn-(mu3*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Cn
d_Mi <- (alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-(mu5*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Mi
d_Ci <- alpha2*TL*Cn-(mu6*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Ci
d_TNF <- (alpha5*((n1**h1)/((n1**h1)+IL10**h1)))*Mi-mu7*(TNF-qTNF)+(alpha5*((n1**h1)/((n1**h1)+IL10**h1)))*Ci
d_IL10 <- alpha7*Mi - mu9*(IL10-qIL10)
return(list(c(d_TL,d_M,d_Cn,d_Mi,d_Ci,d_TNF,d_IL10)))
})
}
veinticinco_de_marzo <- ode(y= state, times = times, func= trypanosoma_29_NOV, parms = parameter)
variable_nueva_abs <- abs((veinticinco_de_marzo[3651,nv]-signos_bien_parametros_normales[3651,nv])/signos_bien_parametros_normales[3651,nv])
basedatos_variables[nrow(basedatos_variables)+1,]<- c(pn,variable_nueva_abs) #aqui va el que se ira moviendo
pn<- pn+ (p_1*a) #aqui va el que no se va a amover alpha2_2
#igual aqui ira el que se ira moviendo
if (x ==10){
}
}
basedatos_variables<- basedatos_variables[-1,]
print(basedatos_variables)
plot(basedatos_variables, main= paste("ASP_",parametros[np],"_",nombre_columnas[nv],sep = ""),ylab= nombre_columnas[nv])
parameter_function_image <- paste("imagenes_analisis_sensibilidad_param_signos_bien/",parametros[np],"_",nombre_columnas[nv],".png", sep = "")
png(parameter_function_image)
plot(basedatos_variables, main= paste("ASP_",parametros[np],"_",nombre_columnas[nv],sep = ""),ylab= nombre_columnas[nv])
dev.off()
parameter_function <- paste("analisis_sensibilidad_param_signos_bien/",parametros[np],"_",nombre_columnas[nv],".rds", sep = "")
saveRDS(basedatos_variables,parameter_function) #si lo guarda asi
}
analisis_SP(alpha1,1,2)
analisis_SP(alpha1,1,2)
analisis_SP(alpha1,1,2)
analisis_SP(alpha1,1,2)
analisis_SP <- function(p,np,nv){
alpha1 <- 5.8*10**-8 #1 o 3.14, ELISA D H
alpha2 <- 2.5*10**-9 #2
#mu1 <- 0.06 # REFERENCIA DE YANG 2015 (HAY OTRO VALOR)
mu1 <- 0.06 #3
nu1 <- 1 # REFERENCIA DE FREITAS, LA OTRA OPCION ES MUY DRASTICA  #4
mu2 <- 5*10**-1 #5
mu3 <- 0 #MISMO VALOR QUE EL DE LOS MACROFAGOS, MU2 #6
alpha3 <- 0 #replicacion Mi #8 PUEDE VARIAR SI ES M1 O M2
alpha4 <- 90 #Replicacion Ci #9
mu5 <- 5*10**-1 #10 #NO AFECTAN, PUEDE SER POR LAS CITOCINAS
mu6 <- 1*10**-6 #11
alpha5 <- 14.4 #12
alpha7 <- 0.45 #SECRECION DE IL10 #13
mu7 <- 24 #TASA DE degradacion DE TNF #en base a la literatura CADA 18 MIN #14
mu9 <- 19.2 #15 Degradacion de IL10
n1 <- 17.4 #TNF-IL10
n2 <- 560 #IL10-IL6
h1 <- 3 #TNF-IL10
h2 <- 3.68 #IL10-IL6
M0 <-209# NUMERO EQUIS
qTNF <- 0.14 #16
qIL10 <- 0.15 #17
n3 <- 100 #MTNF
h3 <- 3.16 #MTNF
n4 <- 4.35 #MIL10
h4 <- 0.3#MIL10
nombre_columnas <-colnames(parametronormales)
pn <- as.numeric(p)
p_1 <- pn
parametros <- c("alpha1","alpha2", "mu1", "nu1", "mu2", "mu3", "alpha3", "alpha4", "mu5", "mu6", "alpha5", "alpha7", "mu7", "mu9", "n1", "n2", "h1", "h2", "qIL10", "qTNF","M0")
columna_basedatos <-paste("variable",nombre_columnas[nv],p,sep = "")
basedatos_variables <- data.frame(parametro = p,
columna_basedatos=signos_bien_parametros_normales[3651,nv])
parameter <- c(alpha1,alpha2, mu1, nu1, mu2, mu3, alpha3, alpha4, mu5, mu6, alpha5, alpha7, mu7, mu9, n1, n2, h1, h2, qIL10, qTNF,M0)
state <- c(TL=50, M=209, Cn= 136, Mi= 0, Ci = 0, TNF = 22, IL10 =9.8)
times <- seq(0,3650, by=1)
for (x in 1:10){
################################################
alpha1 <- pn #hacelo cambiar dependiendo el parametro
#####################voy a tener que hacerlo manual
#COLOCAR AQUI EL PARAMETRO QUE ESTAMOS ESCOGIENDO
trypanosoma_29_NOV <- function(t,state,parameter){
with(as.list(c(state,parameter)),  {
d_TL <- -(alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-alpha2*TL*Cn-(mu1*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*TL+(alpha3*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Mi+alpha4*Ci
d_M <- (nu1*((TNF**h1)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*(M0-M)-(alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-(mu2*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*M
d_Cn <- -alpha2*TL*Cn-(mu3*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Cn
d_Mi <- (alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-(mu5*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Mi
d_Ci <- alpha2*TL*Cn-(mu6*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Ci
d_TNF <- (alpha5*((n1**h1)/((n1**h1)+IL10**h1)))*Mi-mu7*(TNF-qTNF)+(alpha5*((n1**h1)/((n1**h1)+IL10**h1)))*Ci
d_IL10 <- alpha7*Mi - mu9*(IL10-qIL10)
return(list(c(d_TL,d_M,d_Cn,d_Mi,d_Ci,d_TNF,d_IL10)))
})
}
veinticinco_de_marzo <- ode(y= state, times = times, func= trypanosoma_29_NOV, parms = parameter)
variable_nueva_abs <- abs((veinticinco_de_marzo[3651,nv]-signos_bien_parametros_normales[3651,nv])/signos_bien_parametros_normales[3651,nv])
basedatos_variables[nrow(basedatos_variables)+1,]<- c(pn,variable_nueva_abs) #aqui va el que se ira moviendo
pn<- pn+ (p_1*a) #aqui va el que no se va a amover alpha2_2
#igual aqui ira el que se ira moviendo
if (x ==10){
}
}
basedatos_variables<- basedatos_variables[-1,]
print(basedatos_variables)
plot(basedatos_variables, main= paste("ASP_",parametros[np],"_",nombre_columnas[nv],sep = ""),ylab= nombre_columnas[nv])
parameter_function_image <- paste("imagenes_analisis_sensibilidad_param_signos_bien/",parametros[np],"_",nombre_columnas[nv],".png", sep = "")
png(parameter_function_image)
plot(basedatos_variables, main= paste("ASP_",parametros[np],"_",nombre_columnas[nv],sep = ""),ylab= nombre_columnas[nv])
dev.off()
parameter_function <- paste("analisis_sensibilidad_param_signos_bien/",parametros[np],"_",nombre_columnas[nv],".rds", sep = "")
saveRDS(basedatos_variables,parameter_function) #si lo guarda asi
}
analisis_SP(alpha1,1,2)
library(deSolve)
#Parametros
alpha1 <- 5.8*10**-8 #1 o 3.14, ELISA D H
alpha2 <- 2.5*10**-9 #2
#mu1 <- 0.06 # REFERENCIA DE YANG 2015 (HAY OTRO VALOR)
mu1 <- 0.06 #3
nu1 <- 1 # REFERENCIA DE FREITAS, LA OTRA OPCION ES MUY DRASTICA  #4
mu2 <- 5*10**-1 #5
mu3 <- 0 #MISMO VALOR QUE EL DE LOS MACROFAGOS, MU2 #6
alpha3 <- 0 #replicacion Mi #8 PUEDE VARIAR SI ES M1 O M2
alpha4 <- 90 #Replicacion Ci #9
mu5 <- 5*10**-1 #10 #NO AFECTAN, PUEDE SER POR LAS CITOCINAS
mu6 <- 1*10**-6 #11
alpha5 <- 14.4 #12
alpha7 <- 0.45 #SECRECION DE IL10 #13
mu7 <- 24 #TASA DE degradacion DE TNF #en base a la literatura CADA 18 MIN #14 #24
mu9 <- 19.2 #15 Degradacion de IL10
n1 <- 17.4 #TNF-IL10
n2 <- 560 #IL10-IL6
h1 <- 3 #TNF-IL10
h2 <- 3.68 #IL10-IL6
M0 <-209# NUMERO EQUIS
qTNF <- 0.14 #16
qIL10 <- 0.15 #17
n3 <- 100 #MTNF
h3 <- 3.16 #MTNF
n4 <- 4.35 #MIL10
h4 <- 0.3#MIL10
signos_bien_parametros_normales <- readRDS("analisis_sensibilidad_param_signos_bien/parametros_normales_signos_bien.rds")
analisis_SP <- function(p,np,nv){
alpha1 <- 5.8*10**-8 #1 o 3.14, ELISA D H
alpha2 <- 2.5*10**-9 #2
#mu1 <- 0.06 # REFERENCIA DE YANG 2015 (HAY OTRO VALOR)
mu1 <- 0.06 #3
nu1 <- 1 # REFERENCIA DE FREITAS, LA OTRA OPCION ES MUY DRASTICA  #4
mu2 <- 5*10**-1 #5
mu3 <- 0 #MISMO VALOR QUE EL DE LOS MACROFAGOS, MU2 #6
alpha3 <- 0 #replicacion Mi #8 PUEDE VARIAR SI ES M1 O M2
alpha4 <- 90 #Replicacion Ci #9
mu5 <- 5*10**-1 #10 #NO AFECTAN, PUEDE SER POR LAS CITOCINAS
mu6 <- 1*10**-6 #11
alpha5 <- 14.4 #12
alpha7 <- 0.45 #SECRECION DE IL10 #13
mu7 <- 24 #TASA DE degradacion DE TNF #en base a la literatura CADA 18 MIN #14
mu9 <- 19.2 #15 Degradacion de IL10
n1 <- 17.4 #TNF-IL10
n2 <- 560 #IL10-IL6
h1 <- 3 #TNF-IL10
h2 <- 3.68 #IL10-IL6
M0 <-209# NUMERO EQUIS
qTNF <- 0.14 #16
qIL10 <- 0.15 #17
n3 <- 100 #MTNF
h3 <- 3.16 #MTNF
n4 <- 4.35 #MIL10
h4 <- 0.3#MIL10
nombre_columnas <-colnames(parametronormales)
pn <- as.numeric(p)
p_1 <- pn
parametros <- c("alpha1","alpha2", "mu1", "nu1", "mu2", "mu3", "alpha3", "alpha4", "mu5", "mu6", "alpha5", "alpha7", "mu7", "mu9", "n1", "n2", "h1", "h2", "qIL10", "qTNF","M0")
columna_basedatos <-paste("variable",nombre_columnas[nv],p,sep = "")
basedatos_variables <- data.frame(parametro = p,
columna_basedatos=signos_bien_parametros_normales[3651,nv])
parameter <- c(alpha1,alpha2, mu1, nu1, mu2, mu3, alpha3, alpha4, mu5, mu6, alpha5, alpha7, mu7, mu9, n1, n2, h1, h2, qIL10, qTNF,M0)
state <- c(TL=50, M=209, Cn= 136, Mi= 0, Ci = 0, TNF = 22, IL10 =9.8)
times <- seq(0,3650, by=1)
for (x in 1:10){
################################################
alpha1 <- pn #hacelo cambiar dependiendo el parametro
#####################voy a tener que hacerlo manual
#COLOCAR AQUI EL PARAMETRO QUE ESTAMOS ESCOGIENDO
trypanosoma_29_NOV <- function(t,state,parameter){
with(as.list(c(state,parameter)),  {
d_TL <- -(alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-alpha2*TL*Cn-(mu1*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*TL+(alpha3*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Mi+alpha4*Ci
d_M <- (nu1*((TNF**h1)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*(M0-M)-(alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-(mu2*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*M
d_Cn <- -alpha2*TL*Cn-(mu3*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Cn
d_Mi <- (alpha1*((TNF**h3)/((n3**h3)+TNF**h3))*(n4**h4)/((n4**h4)+IL10**h4))*TL*M-(mu5*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Mi
d_Ci <- alpha2*TL*Cn-(mu6*((TNF**h3)/((n3**h3)+TNF**h3))*((n4**h4)/((n4**h4)+IL10**h4)))*Ci
d_TNF <- (alpha5*((n1**h1)/((n1**h1)+IL10**h1)))*Mi-mu7*(TNF-qTNF)+(alpha5*((n1**h1)/((n1**h1)+IL10**h1)))*Ci
d_IL10 <- alpha7*Mi - mu9*(IL10-qIL10)
return(list(c(d_TL,d_M,d_Cn,d_Mi,d_Ci,d_TNF,d_IL10)))
})
}
veinticinco_de_marzo <- ode(y= state, times = times, func= trypanosoma_29_NOV, parms = parameter)
variable_nueva_abs <- abs((veinticinco_de_marzo[3651,nv]-signos_bien_parametros_normales[3651,nv])/signos_bien_parametros_normales[3651,nv])
basedatos_variables[nrow(basedatos_variables)+1,]<- c(pn,variable_nueva_abs) #aqui va el que se ira moviendo
pn<- pn+ (p_1*a) #aqui va el que no se va a amover alpha2_2
#igual aqui ira el que se ira moviendo
if (x ==10){
}
}
basedatos_variables<- basedatos_variables[-1,]
print(basedatos_variables)
plot(basedatos_variables, main= paste("ASP_",parametros[np],"_",nombre_columnas[nv],sep = ""),ylab= nombre_columnas[nv])
parameter_function_image <- paste("imagenes_analisis_sensibilidad_param_signos_bien/",parametros[np],"_",nombre_columnas[nv],".png", sep = "")
png(parameter_function_image)
plot(basedatos_variables, main= paste("ASP_",parametros[np],"_",nombre_columnas[nv],sep = ""),ylab= nombre_columnas[nv])
dev.off()
parameter_function <- paste("analisis_sensibilidad_param_signos_bien/",parametros[np],"_",nombre_columnas[nv],".rds", sep = "")
saveRDS(basedatos_variables,parameter_function) #si lo guarda asi
}
analisis_SP(alpha1,1,2)
analisis_SP(alpha1,1,3)
analisis_SP(alpha1,1,4)
analisis_SP(alpha1,1,5)
analisis_SP(alpha1,1,6)
analisis_SP(alpha1,1,7)
analisis_SP(alpha1,1,8)
