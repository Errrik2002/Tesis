library(deSolve)
############## FIN DE EJEMPLO ############
k1 <-90
k2 <-0.1
k3 <-2
k4 <-0.0005
k5 <- 0.1
k6 <- 0.00015
k7 <-1
k8 <-0.01
k9 <-0.5
k10 <-0.001
k11 <-0.01
k12 <-2.9
k13 <-2
k14 <-0.7
k15 <-0.002
k16 <-0.0001
k17 <-0.04
k18 <-0.045
k19 <-0.002
k20 <-0.0001
k21 <- 0.04
k22 <-0.045
k23 <-0.002
k24 <-0.0001
k25 <-0.04
k26 <-0.045
k27 <-0.0001
k28 <-0.1
k29 <-0.00006
k30 <-0.001
k31 <-0.000000001
k32 <-0.000001
k33 <-0.000000001
t1 <- 4
t2 <- 1
LCMV_CTL <- function(t, state, parameter){
with(as.list(c(state, parameter)),{
dP <- k1*P*(t-t1) - k2*P - k3*AB*P - k4*M1*P - k5*P
dPi <- k5&P - k1*Pi*(t-t1) - k6*Pi*CTL
dM <- k7*(M0-M) - k8*M*P
dM1 <- k8*M*P - k9*M1
dDC <- k10*(DC0-DC) - k11*DC*P
dDC1 <- k11*DC*P - k12*DC1
dDCm <- k13*DC1*(t-t2) - k14*DCm
dTh0 <- k15*(th0_0 - th0) - k16*DCm*th0
dTh1 <- k16*DCm*th0 + k17*DCm*th1 - k18*th1
dTCD8 <- k19*(tcd80 - tcd8) - k20*DCm*tcd8
dCTL <- k20*DCm*tcd8 + k21*DCm*CTL - k22*CTL
dBn <- k23*(bn0 - bn) - k24*DCm*bn
dBac <- k24*DCm*bn + k25*DCm*bac - k26*bac - k27*bac
dPC <- k27*bac - k28*PC
dAB <- k29*PC - k30*AB
dMy <- -k31*My*P
dMy1 <- k31*My*P - k32*My1 - k33*My1*CTL
})
}
LCMV_CTL <- function(t, state, parameter){
with(as.list(c(state, parameter)),{
dP <- k1*P*(times-t1) - k2*P - k3*AB*P - k4*M1*P - k5*P
dPi <- k5&P - k1*Pi*(t-t1) - k6*Pi*CTL
dM <- k7*(M0-M) - k8*M*P
dM1 <- k8*M*P - k9*M1
dDC <- k10*(DC0-DC) - k11*DC*P
dDC1 <- k11*DC*P - k12*DC1
dDCm <- k13*DC1*(times-t2) - k14*DCm
dTh0 <- k15*(th0_0 - th0) - k16*DCm*th0
dTh1 <- k16*DCm*th0 + k17*DCm*th1 - k18*th1
dTCD8 <- k19*(tcd80 - tcd8) - k20*DCm*tcd8
dCTL <- k20*DCm*tcd8 + k21*DCm*CTL - k22*CTL
dBn <- k23*(bn0 - bn) - k24*DCm*bn
dBac <- k24*DCm*bn + k25*DCm*bac - k26*bac - k27*bac
dPC <- k27*bac - k28*PC
dAB <- k29*PC - k30*AB
dMy <- -k31*My*P
dMy1 <- k31*My*P - k32*My1 - k33*My1*CTL
})
}
out <- ode(y= state, times = times, func= immpasiva, parms = parameters)
parameters <- c(parameters <- c(k1,k2,k3,k4,k5,k6,k7,k8,k9,k10,k11,k12,k13,k14,k15,k16,k17,k18,k19,k20,k21,k22,k23,k24,k25,k26,k27,k28,k29,k30,k31,k32,k33,t1,t2))
state <- c(dP =50, dPi = 0, dM=209, dM1=0, dDC=209,dDC1=0,dDCm=0,dTh0=1277,dTh1=0,dTCD8=708,dCTL=0,dBn=2273,dBac=0,dPC=0,dAB=0.2,dMy=136,dMy1=0)
times <- seq(0,20, by=1)
out <- ode(y= state, times = times, func= immpasiva, parms = parameters)
out <- ode(y= state, times = times, func= LCMV_CTL, parms = parameters)
install.packages("earlywarnings")
install.packages("EWS")
install.packages("EWSmethods")
